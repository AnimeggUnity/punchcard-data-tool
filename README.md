# 🛠️ 打卡系統資料處理工具

### 專案名稱：**punchcard-data-tool**

---

## 📖 簡介

這是一個用於處理和轉換打卡系統資料的 Python 工具集。  
提供資料整理、夜點清單生成、打卡紀錄查詢等功能，協助簡化打卡紀錄的統整與應用。

---

## 📂 資料來源說明

### 📑 1. 刷卡資料
- **來源**：新北市政府公務系統
- **格式**：Excel (.xlsx)
- **路徑**：`data/刷卡資料.xlsx`
- **說明**：系統自動讀取公務系統匯出的刷卡紀錄。

### 📑 2. 司機名單
- **來源**：全單位名單
- **格式**：Excel (.xlsx)
- **路徑**：`data/list.xlsx`
- **說明**：用於比對及整合打卡資料，可自由增減名單內容。

---

## ✨ 功能特點

- **資料整理與轉換**：
  - 清理並標準化原始打卡資料。
  - 支援轉換成 xlsx、csv、html 等格式。
- **夜點清單管理**：
  - 計算夜點資料，自動生成 HTML 或 CSV 清單。
- **打卡紀錄查詢**：
  - 支援多條件查詢，輸出為 HTML 或 CSV。
- **完整查詢功能**：
  - 提供更完整細緻的查詢與統計報告。

---

## 🖥️ 系統需求

- Python 3.6 或以上
- 必要套件：
  - `pandas`
  - `sqlite3`
  - `logging`
  - `pathlib`
  - `typing`
  - `argparse`

---

## 🛠️ 安裝步驟

```bash
# 1. 克隆專案
git clone [專案URL]
cd [專案目錄]

# 2. 安裝必要套件
pip install -r requirements.txt
```

---

## 🗂️ 程式檔案說明

### 📋 資料整理與轉換
| 檔案名稱 | 功能說明 |
| :--- | :--- |
| `01 資料整理_0117.py` | 讀取刷卡資料與司機名單，清理並存入資料庫。 |
| `04 轉換xlsx到csv.py` | 將 Excel 轉換為 CSV 格式。 |

### 📋 夜點清單管理
| 檔案名稱 | 功能說明 |
| :--- | :--- |
| `02 新夜點清單htm_0120.py` | 生成 HTML 格式的夜點清單。 |
| `02 夜點清算csv_0627.py` | 生成 CSV 格式的夜點清單。 |

### 📋 打卡紀錄查詢
| 檔案名稱 | 功能說明 |
| :--- | :--- |
| `03 打卡紀錄查詢htm.py` | 依條件查詢並生成 HTML 結果。 |
| `03 打卡記錄查詢csv.py` | 依條件查詢並生成 CSV 結果。 |

### 📋 完整查詢功能
| 檔案名稱 | 功能說明 |
| :--- | :--- |
| `09 打卡紀錄完整查詢.py` | 支援複合條件的完整打卡紀錄查詢。 |

### 📋 其他功能
| 檔案名稱 | 功能說明 |
| :--- | :--- |
| `stay.py` | 處理停留時間計算並生成報表。 |

---

## 📚 使用說明

### 1. 資料準備
- 將刷卡資料放入 `data/刷卡資料.xlsx`
- 將司機名單放入 `data/list.xlsx`
- 確認名單包含必要欄位（公務帳號、卡號、姓名、班別等）

### 2. 資料整理

```bash
python "01 資料整理_0117.py"
```
> 整理完成後，會生成 `db/source.db` 資料庫，並記錄於 `logs` 日誌中。

### 3. 夜點清單生成

```bash
python "02 新夜點清單htm_0120.py"  # 生成 HTML
python "02 夜點清算csv_0627.py"    # 生成 CSV
```

### 4. 打卡紀錄查詢

```bash
python "03 打卡紀錄查詢htm.py"  # 查詢並輸出 HTML
python "03 打卡記錄查詢csv.py"  # 查詢並輸出 CSV
```

### 5. 資料格式轉換

```bash
python "04 轉換xlsx到csv.py"
```

### 6. 完整查詢

```bash
python "09 打卡紀錄完整查詢.py"
```

---

## 📁 目錄結構

```
data/              # 存放刷卡資料與司機名單
db/                # 資料庫檔案 (source.db)
output/            # 各種輸出結果 (CSV、HTML等)
logs/              # 執行日誌
scripts/           # Python 執行腳本 (可自訂)
requirements.txt   # 套件需求清單
README.md          # 說明文件
```
